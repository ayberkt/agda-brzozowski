Thanks to Fabian Ruch and Andrea Vezzosi for their suggestions and Agda help.
