Thanks to Fabian Ruch for his suggestions and Agda help.
